#!/usr/bin/env python
import Skype4Py
import sys

import commands
import threading

def onMessage(msg, status):
	commands.handle(msg, status).start()

if __name__ == '__main__':
	skype = None
	try:
		skype = Skype4Py.Skype();
		print 'Skype4Py Initalized'
	except:
		print 'Failed to load Skype4Py, exiting...'
		sys.exit()
	if skype.Client.IsRunning == True:
		print 'Skype is running'
	else:
		print 'Skype not found, starting...'
		try:
			skype.Client.Start()
			print 'Skype Started'
		except:
			print 'Failed to start Skype, exiting...'
			sys.exit()
	try:
		skype.Attach()
		skype.OnMessageStatus = onMessage
	except:
		print 'Skype4Py failed to attach, exiting...'
		sys.exit()
		
	while True:
        	raw_input('')
